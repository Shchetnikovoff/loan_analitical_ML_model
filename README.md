# Прогнозирование одобрения кредита - Kaggle Competition

## Описание
Проект реализует систему машинного обучения для предсказания статуса одобрения кредита на основе финансовых и персональных данных клиента для соревнования Kaggle Playground Series S4E10. Система использует Gradient Boosting Classifier с настройкой гиперпараметров через GridSearchCV.

## Возможности
- **Модель машинного обучения**: Gradient Boosting Classifier с настройкой гиперпараметров через GridSearchCV
- **Интерактивный интерфейс**: Консольный интерфейс для оценки кредитного риска новых клиентов
- **Полный пайплайн**: Включает предобработку данных, обучение модели, оценку и предсказания
- **Категории риска**: Низкий, средний и высокий риск

## Результаты
- **Точность на валидации**: 95.17%
- **ROC-AUC на валидации**: 95.76%
- **Лучшие параметры**:
  - learning_rate: 0.1
  - max_depth: 5
  - n_estimators: 200

## Установка
1.  **Установить зависимости**:
    ```bash
    pip install -r requirements.txt
    ```

2.  **Скачать данные Kaggle**:
    - Скачайте данные соревнования: https://www.kaggle.com/competitions/playground-series-s4e10/data
    - Поместите `train.csv` и `test.csv` в `data/playground-series-s4e10/`

## Использование

### 1. Интерактивная оценка кредитного риска
Запустите интерактивный интерфейс:
```bash
python credit_risk_interface.py
```
Позволяет вводить данные клиента и получать предсказания кредитного риска.

### 2. Обучение и создание submission
Для обучения модели и генерации файла submission:
```bash
cd src
python train.py
```

### 3. Создание Jupyter Notebook
Для генерации аналитического ноутбука:
```bash
python create_notebook.py
```

### 4. Полное тестирование системы
Для запуска комплексного теста:
```bash
python test_full_system.py
```

## Структура проекта
-   `data/`: Содержит train.csv и test.csv с данными о кредитном риске
-   `src/`: Исходный код для предобработки и моделирования
    -   `model.py`: Реализация модели машинного обучения
    -   `preprocessing.py`: Функции предобработки данных
    -   `train.py`: Основной скрипт обучения
-   `notebooks/`: Jupyter ноутбуки для анализа данных
-   `submission.csv`: Сгенерированный файл submission
-   `create_notebook.py`: Скрипт для создания Jupyter ноутбука
-   `credit_risk_interface.py`: Интерактивный интерфейс клиента
-   `generate_data.py`: Скрипт для создания синтетических данных
-   `test_full_system.py`: Скрипт комплексного тестирования

## Реализация требований задания
✅ **Алгоритм**: Gradient Boosting Classifier
✅ **Настройка гиперпараметров**: GridSearchCV с сеткой параметров
✅ **Предобработка данных**: Обработка числовых и категориальных признаков
✅ **Оценка модели**: Метрики точности и classification report
✅ **Интерактивный интерфейс**: Для оценки кредитного риска клиентов

## Категории кредитного риска
- **Низкий**: Очень низкий риск, кредит может быть выдан
- **Средний**: Умеренный риск, кредит может быть выдан с осторожностью
- **Высокий**: Высокий риск, в кредите следует отказать

## Признаки (Kaggle Dataset)

**Числовые признаки (7)**:
- person_age: Возраст человека
- person_income: Годовой доход
- person_emp_length: Стаж работы в годах
- loan_amnt: Сумма кредита
- loan_int_rate: Процентная ставка по кредиту
- loan_percent_income: Сумма кредита в процентах от дохода
- cb_person_cred_hist_length: Длина кредитной истории в годах

**Категориальные признаки (4)**:
- person_home_ownership: Статус владения жильем (RENT, OWN, MORTGAGE)
- loan_intent: Цель кредита (EDUCATION, MEDICAL, PERSONAL, VENTURE, DEBTCONSOLIDATION, HOMEIMPROVEMENT)
- loan_grade: Класс кредита (A, B, C, D, E, F)
- cb_person_default_on_file: История дефолтов (Y/N)

**Целевая переменная**:
- loan_status: 0 = без дефолта, 1 = дефолт
